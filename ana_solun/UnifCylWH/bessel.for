C 1. Revised by Bin Teng  in 1995, for DBJ,...
C 2. Revised by Bin Teng on Oct. 13, 1997 for BJ(-n) and DBJ(-n)
C
C
C  
      DOUBLE PRECISION FUNCTION BY(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      CALL BESELY(X,N,BY0,BY1) 
      BY=BY0 
      RETURN 
      END      
C 
      DOUBLE PRECISION FUNCTION DBY(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      N1=N+1 
      CALL BESELY(X,N1,BY1,BY0) 
      DBY=N/X*BY0-BY1 
      RETURN 
      END 
C 
      DOUBLE PRECISION FUNCTION BJ(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)  
      DIMENSION B(100),ISGN(0:1)
      DATA ISGN/1, -1/    
      
      IF (N .GE. 0)  THEN
        NB=N+1 
        IZE=0 
        CALL BESLJI(X,NB,IZE,B,NCALC) 
        BJ=B(NB)
      ELSE
        M=ABS(N)
        ID=MOD(M,2)
        NB=M+1 
        IZE=0 
        CALL BESLJI(X,NB,IZE,B,NCALC)   
        BJ=ISGN(ID)*B(NB)
      END IF
C         
      RETURN 
      END 
C       

      DOUBLE PRECISION FUNCTION DBJ(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      DIMENSION B(100),ISGN(0:1) 
      DATA ISGN/1, -1/    
      
      IF (N .GE. 0)  THEN

        NB1=N+2 
        IZE=0 
        CALL BESLJI(X,NB1,IZE,B,NCALC) 
        IF (N .EQ. 0) THEN
          DBJ=-B(NB1)
        ELSE
          DBJ=0.5D0*(B(N)-B(NB1))
	  END IF          
C
      ELSE 

        M=ABS(N)
        ID=MOD(M,2)
        NB1=M+2 
        IZE=0 
        CALL BESLJI(X,NB1,IZE,B,NCALC) 
        IF (M .EQ. 0) THEN
          DBJ=-B(NB1)
        ELSE
          DBJ=0.5D0*(B(M)-B(NB1))
	  END IF          

        DBJ=ISGN(ID)*DBJ       
     
      END IF
C            
      RETURN 
      END 
C 
      DOUBLE PRECISION FUNCTION BK(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      CALL BESELK(X,N,BK0,BK1) 
      BK=BK0 
      RETURN 
      END 
C 
      DOUBLE PRECISION FUNCTION DBK(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      N1=N+1 
      CALL BESELK(X,N1,BK1,BK0) 
      DBK=N/X*BK0-BK1 
      RETURN 
      END 
C 
      DOUBLE PRECISION FUNCTION BI(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      DIMENSION B(100) 
      NB=N+1 
      IZE=1 
      CALL BESLJI(X,NB,IZE,B,NCALC) 
      BI=B(NB) 
      RETURN 
      END 
C 
      DOUBLE PRECISION FUNCTION DBI(X,N) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      DIMENSION B(100) 
      NB=N+1 
      NB1=NB+1 
      IZE=1 
      CALL BESLJI(X,NB1,IZE,B,NCALC) 
      	IF (N .EQ. 0)  THEN
          DBI=B(NB1)
      	ELSE
          DBI=0.5D0*(B(N)+B(NB1)) 
	END IF          
      RETURN 
      END 
C 
C 
C 
      SUBROUTINE BESELY(X,INN,BYN1,BYN) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      DIMENSION BY(100) 
      IFAIL=0 
      BY(1)=S17ACF(X,IFAIL) 
      BY(2)=S17ADF(X,IFAIL) 
   10 IN=IABS(INN) 
      IF(INN.LT.1)IN=IN+1 
      I=2 
      IF(IN.EQ.1)GO TO 2 
      IN1=IN-1 
      DO 1 J=1,IN1 
      I=I+1 
    1 BY(I)=2.D0*(I-2)/X*BY(I-1) - BY(I-2) 
    2 BYN1=BY(I) 
      BYN =BY(I-1) 
      IF(INN.GE.1)RETURN 
      TEMP=BYN 
      BYN =BYN1 
      IF(MOD(INN,2).EQ.0)BYN=-BYN 
      BYN1=TEMP 
      IF(MOD(INN-1,2).EQ.0)BYN1=-BYN1 
      RETURN 
      END 
C 
      SUBROUTINE BESELK(X,INN,BKN1,BKN) 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z) 
      DIMENSION BK(200) 
      IFAIL=0 
      BK(1)=S18ACF(X,IFAIL) 
      BK(2)=S18ADF(X,IFAIL) 
   10 IN=IABS(INN) 
      IF(INN.LT.1)IN=IN+1 
      I=2 
      IF(IN.EQ.1)GO TO 2 
      IN1=IN-1 
      DO 1 J=1,IN1 
      I=I+1 
    1 BK(I)=2.D0*(I-2)/X*BK(I-1) + BK(I-2) 
    2 BKN1=BK(I) 
      BKN =BK(I-1) 
      IF(INN.GE.1)RETURN 
      TEMP=BKN 
      BKN =BKN1 
      BKN1=TEMP 
      RETURN 
      END 
C 
      SUBROUTINE BESLJI(X,NB,IZE,B,NCALC) 
      DOUBLE PRECISION 
     1X,B,P,TEST,TEMPA,TEMPB,TEMPC,EXPARG,SIGN,SUM,TOVER, 
     2PLAST,POLD,PSAVE,PSAVEL 
      DIMENSION B(NB) 
      DATA NSIG,NTEN,LARGEX,EXPARG/19,307,100000,7.D2/ 
      TEMPA=DABS(X) 
      MAGX=IFIX(SNGL(TEMPA)) 
      IF(NB.GT.0.AND.MAGX.LE.LARGEX.AND.(IZE.EQ.0.OR. 
     1(IZE.EQ.1.AND.TEMPA.LE.EXPARG))) GO TO 1 
      NCALC=MIN0(NB,0)-1 
      RETURN 
1     SIGN=DBLE(FLOAT(1-2*IZE)) 
      NCALC=NB 
      IF(TEMPA**4.LT..1D0**NSIG) GO TO 30 
      NBMX=NB-MAGX 
      N=MAGX+1 
      PLAST=1.D0 
      P=DBLE(FLOAT(2*N))/TEMPA 
      TEST=2.D0*1.D1**NSIG 
      IF(IZE.EQ.1.AND.2*MAGX.GT.5*NSIG) TEST=DSQRT(TEST*P) 
      IF(IZE.EQ.1.AND.2*MAGX.LE.5*NSIG)TEST=TEST/1.585**MAGX 
      M=0 
      IF(NBMX.LT.3) GO TO 4 
      TOVER=1.D1**(NTEN-NSIG) 
      NSTART=MAGX+2 
      NEND=NB-1 
      DO 3 N=NSTART,NEND 
      POLD=PLAST 
      PLAST=P 
      P=DBLE(FLOAT(2*N))*PLAST/TEMPA-SIGN*POLD 
      IF(P-TOVER) 3,3,5 
3     CONTINUE 
      N=NEND 
      TEST=DMAX1(TEST,DSQRT(PLAST*1.D1**NSIG)*DSQRT(2.D0*P)) 
4     N=N+1 
      POLD=PLAST 
      PLAST=P 
      P=DBLE(FLOAT(2*N))*PLAST/TEMPA-SIGN*POLD 
      IF(P.LT.TEST) GO TO 4 
      IF(IZE.EQ.1.OR.M.EQ.1) GO TO 12 
      M=1 
      TEMPB=P/PLAST 
      TEMPC=DBLE(FLOAT(N+1))/TEMPA 
      IF(TEMPB+1.D0/TEMPB.GT.2.D0*TEMPC) TEMPB=TEMPC+DSQRT 
     1(TEMPC**2-1.D0) 
      TEST=TEST/DSQRT(TEMPB-1.D0/TEMPB) 
      IF(P-TEST) 4,12,12 
5     TOVER=1.D1**NTEN 
      P=P/TOVER 
      PLAST=PLAST/TOVER 
      PSAVE=P 
      PSAVEL=PLAST 
      NSTART=N+1 
6     N=N+1 
      POLD=PLAST 
      PLAST=P 
      P=DBLE(FLOAT(2*N))*PLAST/TEMPA-SIGN*POLD 
      IF(P.LE.1.D0) GO TO 6 
      TEMPB=DBLE(FLOAT(2*N))/TEMPA 
      IF(IZE.EQ.1) GO TO 8 
      TEMPC=.5D0*TEMPB 
      TEMPB=PLAST/POLD 
      IF(TEMPB+1.D0/TEMPB.GT.2.D0*TEMPC)TEMPB=TEMPC+DSQRT 
     1(TEMPC**2-1.D0) 
8     TEST=.5D0*POLD*PLAST*(1.D0-1.D0/TEMPB**2)/1.D1**NSIG 
      P=PLAST*TOVER 
      N=N-1 
      NEND=MIN0(NB,N) 
      DO 9 NCALC=NSTART,NEND 
      POLD=PSAVEL 
      PSAVEL=PSAVE 
      PSAVE=DBLE(FLOAT(2*N))*PSAVEL/TEMPA-SIGN*POLD 
      IF(PSAVE*PSAVEL-TEST) 9,9,10 
9     CONTINUE 
      NCALC=NEND+1 
10    NCALC=NCALC-1 
12    N=N+1 
      M=2*N-4*(N/2) 
      TEMPB=0.D0 
      TEMPA=1.D0/P 
      SUM=DBLE(FLOAT(M))*TEMPA 
      NEND=N-NB 
      IF(NEND) 17,15,13 
13    DO 14 L=1,NEND 
      N=N-1 
      TEMPC=TEMPB 
      TEMPB=TEMPA 
      TEMPA=(DBLE(FLOAT(2*N))*TEMPB)/X-SIGN*TEMPC 
      M=2-M 
14    SUM=SUM+DBLE(FLOAT(M))*TEMPA 
15    B(N)=TEMPA 
      IF(NB.GT.1) Go TO 16 
      SUM=SUM-TEMPA 
      GO TO 23 
16    N=N-1 
      B(N) =(DBLE(FLOAT(2*N))*TEMPA)/X-SIGN*TEMPB 
      IF(N.EQ.1) GO TO 22 
      M=2-M 
      SUM=SUM+DBLE(FLOAT(M))*B(N) 
      GO TO 19 
17    B(N)=TEMPA 
      NEND=-NEND 
      DO 18 L=1,NEND 
18    B(N+L)=0.0D0 
19    NEND=N-2 
      IF(NEND.EQ.0) GO TO 21 
      DO 20 L=1,NEND 
      N=N-1 
      B(N)=(DBLE(FLOAT(2*N))*B(N+1))/X-SIGN*B(N+2) 
      M=2-M 
20    SUM=SUM+DBLE(FLOAT(M))*B(N) 
21    B(1)=2.D0*B(2)/X-SIGN*B(3) 
22    SUM=SUM+B(1) 
23    IF(IZE.EQ.0) GO TO 25 
      TEMPA=DEXP(DABS(X)) 
      SUM=2.D0*SUM/(TEMPA+1.D0/TEMPA) 
25    DO 26 N=1,NB 
26    B(N)=B(N)/SUM 
      RETURN 
30    TEMPA=1.D0 
      TEMPB=-0.25D0*X*X*SIGN 
      B(1)=1.D0+TEMPB 
      IF(NB.EQ.1) GO TO 32 
      DO 31 N=2,NB 
      TEMPA=TEMPA*X/DBLE(FLOAT(2*N-2)) 
31    B(N)=TEMPA*(1.D0+TEMPB/DBLE(FLOAT(N))) 
32    RETURN 
      END 
C 
C JZY0 
      DOUBLE PRECISION FUNCTION S17ACF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECIS IONX 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION A,B,C,CX,EGAM,G,SX,T2,T,TBPI,XBIG,XVSMAL,Y 
      DOUBLE PRECISION DLOG,DCOS,DSIN,DSQRT 
      INTEGER P01AAF 
      DATA SRNAME/8H S17ACF / 
      DATA XBIG,XVSMAL,TBPI,EGAM/3.4D+15,3.2D-9,6.366197723675813D-1,5.77 
     *2156649015329D-1/ 
      IF(X.GT.XBIG)GOTO60 
      IF(X.LE.0.0D0)GOTO80 
      IFAIL=0 
      IF(X.GT.8.0D0)GOTO40 
      IF(X.GT.XVSMAL)GOTO20 
      S17ACF=TBPI*(DLOG(0.5D0*X)+EGAM) 
      GOTO100 
20    T=3.125D-2*X*X-1.0D0 
      T2=2.0D0*T 
      A=+1.222000000000000D-17 
      B=T2*A-7.588500000000000D-16 
      C=T2*B-A+4.125321000000000D-14 
      A=T2*C-B-1.943834690000000D-12 
      B=T2*A-C+7.848696314000000D-11 
      C=T2*B-A-2.679253530560000D-9 
      A=T2*C-B+7.608163592419000D-8 
      B=T2*A-C-1.761946907762150D-6 
      C=T2*B-A+3.246032882100508D-5 
      A=T2*C-B-4.606261662062751D-4 
      B=T2*A-C+4.819180069467605D-3 
      C=T2*B-A-3.489376941140889D-2 
      A=T2*C-B+1.580671023320973D-1 
      B=T2*A-C-3.700949938726498D-1 
      C=T2*B-A+2.651786132033368D-1 
      A=T2*C-B-8.723442352852221D-3 
      Y=T*A-C+1.577279714748901D-1 
      A=+3.900000000000000D-19 
      B=T2*A-2.698000000000000D-17 
      C=T2*B-A+1.643490000000000D-15 
      A=T2*C-B-8.747341000000000D-14 
      B=T2*A-C+4.026330820000000D-12 
      C=T2*B-A-1.583755254200000D-10 
      A=T2*C-B+5.248794787330000D-9 
      B=T2*A-C-1.440723327401900D-7 
      C=T2*B-A+3.206532537654800D-6 
      A=T2*C-B-5.632079141056987D-5 
      B=T2*A-C+7.531135932577742D-4 
      C=T2*B-A-7.287962479552079D-3 
      A=T2*C-B+4.719668959576339D-2 
      B=T2*A-C-1.773020127811436D-1 
      C=T2*B-A+2.615673462550466D-1 
      A=T2*C-B+1.790343140771827D-1 
      B=T2*A-C-2.744743055297453D-1 
      G=T*B-A-3.314611320328494D-2 
      S17ACF=TBPI*Y*DLOG(X)+G 
      GOTO100 
40    G=X-0.5D0/TBPI 
      Y=DSQRT(TBPI/X) 
      CX=DCOS(G)*Y*8.0D0/X 
      SX=DSIN(G)*Y 
      T=128.0D0/(X*X)-1.0D0 
      Y=+9.994572757882520D-1+T*(-5.363673192130046D-4+T*(+6.13741608010 
     *9260D-6+T*(-2.052744815651600D-7+T*(+1.280376144344000D-8+T*(-1.21 
     *2118196320000D-9+T*(+1.550056428800000D-10+T*(-2.488272768000000D- 
     *11+T*(+4.787020800000000D-12+T*(-1.063656960000000D-12+T*(+2.45294 
     *0800000000D-13+T*(-6.418432000000000D-14+T*(+3.340288000000000D-14 
     *+T*(-1.179648000000000D-14))))))))))))) 
      G=-1.555511387951352D-2+T*(+6.833149099343900D-5+T*(-1.47713883264 
     *5940D-6+T*(+7.106214859300000D-8+T*(-5.668716130240000D-9+T*(+6.43 
     *2781732800000D-10+T*(-9.470347744000000D-11+T*(+1.703309184000000D 
     *-11+T*(-3.590942720000000D-12+T*(+8.598553600000000D-13+T*(-2.2880 
     *76800000000D-13+T*(+6.951936000000000D-14+T*(-2.279424000000000D-1 
     *4+T*(+4.751360000000000D-15+T*(-1.146880000000000D-15+T*(+2.129920 
     *000000000D-15+T*(-9.830400000000000D-16)))))))))))))))) 
      S17ACF=G*CX+Y*SX 
      GOTO100 
60    IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S17ACF=DSQRT(TBPI/X) 
      GOTO100 
80    IFAIL=P01AAF(IFAIL,2,SRNAME) 
      S17ACF=0.0D0 
100   RETURN 
      END 
C 
C JZY1 
      DOUBLE PRECISION FUNCTION S17ADF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECISION X 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION A,B,C,CX,G,SX,T2,T,TBPI,XBIG,XSEST,XSMALL,Y 
      DOUBLE PRECISION DLOG,DCOS,DSIN,DSQRT 
      INTEGER P01AAF 
      DATA SRNAME/8H S17ADF / 
      DATA XSMALL,XBIG,TBPI/7.9D-10,3.4D+15,6.366197723675813D-1/ 
      DATA XSEST/8.8D-36/ 
      IF(X.GT.8.0D0)GOTO40 
      IF(X.GT.XSMALL)GOTO20 
      IF(X.LE.XSEST)GOTO80 
      S17ADF=-TBPI/X 
      IFAIL=0 
      GOTO120 
20    T=3.125D-2*X*X-1.0D0 
      T2=2.0D0*T 
      A=+2.950000000000000D-18 
      B=T2*A-1.955400000000000D-16 
      C=T2*B-A+1.138572000000000D-14 
      A=T2*C-B-5.777404200000000D-13 
      B=T2*A-C+2.528123664000000D-11 
      C=T2*B-A-9.424212981600000D-10 
      A=T2*C-B+2.949707007278000D-8 
      B=T2*A-C-7.617587805400300D-7 
      C=T2*B-A+1.588701923993213D-5 
      A=T2*C-B-2.604443893485807D-4 
      B=T2*A-C+3.240270182683857D-3 
      C=T2*B-A-2.917552480615421D-2 
      A=T2*C-B+1.777091172397283D-1 
      B=T2*A-C-6.614439341345433D-1 
      C=T2*B-A+1.287994098857678D+0 
      A=T2*C-B-1.191801160541217D+0 
      Y=T*A-C+6.483587706052649D-1 
      A=-6.580000000000000D-18 
      B=T2*A+4.277300000000000D-16 
      C=T2*B-A-2.440949000000000D-14 
      A=T2*C-B+1.211433210000000D-12 
      B=T2*A-C-5.172121473000000D-11 
      C=T2*B-A+1.875470324730000D-9 
      A=T2*C-B-5.688440039919000D-8 
      B=T2*A-C+1.416624364492350D-6 
      C=T2*B-A-2.830464014951480D-5 
      A=T2*C-B+4.404786298670995D-4 
      B=T2*A-C-5.131641161061085D-3 
      C=T2*B-A+4.231918035333690D-2 
      A=T2*C-B-2.266249915567549D-1 
      B=T2*A-C+6.756157807721877D-1 
      C=T2*B-A-7.672963628866459D-1 
      A=T2*C-B-1.286973843813500D-1 
      G=T*A-C+2.030410588593425D-2 
      S17ADF=0.125D0*X*(DLOG(X)*Y*TBPI+G)-TBPI/X 
      IFAIL=0 
      GOTO120 
40    IF(X.GT.XBIG)GOTO60 
      G=X-1.5D0/TBPI 
      Y=DSQRT(TBPI/X) 
      CX=DCOS(G)*Y*8.0D0/X 
      SX=DSIN(G)*Y 
      T=128.0D0/(X*X)-1.0D0 
      Y=+1.000907026278082D+0+T*(+8.988049416705579D-4+T*(-7.95969469843 
     *8460D-6+T*(+2.453676622275600D-7+T*(-1.470851298896000D-8+T*(+1.36 
     *0305801280000D-9+T*(-1.713107584000000D-10+T*(+2.720407296000000D- 
     *11+T*(-5.191139840000000D-12+T*(+1.146224640000000D-12+T*(-2.63372 
     *8000000000D-13+T*(+6.863872000000000D-14+T*(-3.545088000000000D-14 
     *+T*(+1.249280000000000D-14))))))))))))) 
      G=+4.677687402744898D-2+T*(-9.621458822054416D-5+T*(+1.82120185123 
     *0760D-6+T*(-8.291960709292000D-8+T*(+6.420132503440000D-9+T*(-7.15 
     *1105048000000D-10+T*(+1.039509318400000D-10+T*(-1.852480000000000D 
     *-11+T*(+3.875544320000000D-12+T*(-9.232281600000000D-13+T*(+2.5022 
     *46400000000D-13+T*(-7.439360000000000D-14+T*(+1.757184000000000D-1 
     *4+T*(-4.833280000000000D-15+T*(+5.324800000000000D-15+T*(-2.293760 
     *000000000D-15))))))))))))))) 
      S17ADF=G*CX+Y*SX 
      IFAIL=0 
      GOTO120 
60    IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S17ADF=DSQRT(TBPI/X) 
      GOTO120 
80    IF(X.GT.0.0D0)GOTO100 
      IFAIL=P01AAF(IFAIL,2,SRNAME) 
      S17ADF=0.0D0 
      GOTO120 
100   IFAIL=P01AAF(IFAIL,3,SRNAME) 
      S17ADF=-1.0D0/XSEST 
120   RETURN 
      END 
C 
C JZJ0 
      DOUBLE PRECISION FUNCTION S17AEF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECISION X 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION A,B,C,CX,G,SX,T2,T,TBPI,XBIG,XVSMAL,Y 
      DOUBLE PRECISION DCOS,DSIN,DSQRT 
      INTEGER P01AAF 
      DATA SRNAME/8H S17AEF / 
      DATA XBIG,XVSMAL,TBPI/3.4D+15,3.2D-9,6.366197723675813D-1/ 
      T=DABS(X) 
      IF(T.GT.XBIG)GOTO60 
      IFAIL=0 
      IF(T.GT.8.0D0)GOTO40 
      IF(T.GT.XVSMAL)GOTO20 
      S17AEF=1.0D0 
      GOTO80 
20    T=3.125D-2*T*T-1.0D0 
      T2=2.0D0*T 
      A=+1.222000000000000D-17 
      B=T2*A-7.588500000000000D-16 
      C=T2*B-A+4.125321000000000D-14 
      A=T2*C-B-1.943834690000000D-12 
      B=T2*A-C+7.848696314000000D-11 
      C=T2*B-A-2.679253530560000D-9 
      A=T2*C-B+7.608163592419000D-8 
      B=T2*A-C-1.761946907762150D-6 
      C=T2*B-A+3.246032882100508D-5 
      A=T2*C-B-4.606261662062751D-4 
      B=T2*A-C+4.819180069467605D-3 
      C=T2*B-A-3.489376941140889D-2 
      A=T2*C-B+1.580671023320973D-1 
      B=T2*A-C-3.700949938726498D-1 
      C=T2*B-A+2.651786132033368D-1 
      A=T2*C-B-8.723442352852221D-3 
      Y=T*A-C+1.577279714748901D-1 
      S17AEF=Y 
      GOTO80 
40    G=T-0.5D0/TBPI 
      Y=DSQRT(TBPI/T) 
      CX=DCOS(G)*Y 
      SX=-DSIN(G)*Y*8.0D0/T 
      T=128.0D0/(T*T)-1.0D0 
      Y=+9.994572757882520D-1+T*(-5.363673192130046D-4+T*(+6.13741608010 
     *9260D-6+T*(-2.052744815651600D-7+T*(+1.280376144344000D-8+T*(-1.21 
     *2118196320000D-9+T*(+1.550056428800000D-10+T*(-2.488272768000000D- 
     *11+T*(+4.787020800000000D-12+T*(-1.063656960000000D-12+T*(+2.45294 
     *0800000000D-13+T*(-6.418432000000000D-14+T*(+3.340288000000000D-14 
     *+T*(-1.179648000000000D-14))))))))))))) 
      G=-1.555511387951352D-2+T*(+6.833149099343900D-5+T*(-1.47713883264 
     *5940D-6+T*(+7.106214859300000D-8+T*(-5.668716130240000D-9+T*(+6.43 
     *2781732800000D-10+T*(-9.470347744000000D-11+T*(+1.703309184000000D 
     *-11+T*(-3.590942720000000D-12+T*(+8.598553600000000D-13+T*(-2.2880 
     *76800000000D-13+T*(+6.951936000000000D-14+T*(-2.279424000000000D-1 
     *4+T*(+4.751360000000000D-15+T*(-1.146880000000000D-15+T*(+2.129920 
     *000000000D-15+T*(-9.830400000000000D-16)))))))))))))))) 
      S17AEF=Y*CX+G*SX 
      GOTO80 
60    IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S17AEF=DSQRT(TBPI/T) 
80    RETURN 
      END 
C 
C JZJ1 
      DOUBLE PRECISION FUNCTION S17AFF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECISION X 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION A,B,C,CX,G,SX,T2,T,TBPI,XBIG,XVSMAL,Y 
      DOUBLE PRECISION DCOS,DSIN,DSQRT 
      INTEGE RP01AAF 
      DATA SRNAME/8H S17AFF / 
      DATA XVSMAL,XBIG,TBPI/3.2D-9,3.4D+15,6.366197723675813D-1/ 
      T=DABS(X) 
      IF(T.GT.XBIG)GOTO60 
      IFAIL=0 
      IF(T.GT.8.0D0)GOTO40 
      Y=4.0D0 
      IF(T.LE.XVSMAL)GOTO20 
      T=3.125D-2*T*T-1.0D0 
      T2=2.0D0*T 
      A=+2.950000000000000D-18 
      B=T2*A-1.955400000000000D-16 
      C=T2*B-A+1.138572000000000D-14 
      A=T2*C-B-5.777404200000000D-13 
      B=T2*A-C+2.528123664000000D-11 
      C=T2*B-A-9.424212981600000D-10 
      A=T2*C-B+2.949707007278000D-8 
      B=T2*A-C-7.617587805400300D-7 
      C=T2*B-A+1.588701923993213D-5 
      A=T2*C-B-2.604443893485807D-4 
      B=T2*A-C+3.240270182683857D-3 
      C=T2*B-A-2.917552480615421D-2 
      A=T2*C-B+1.777091172397283D-1 
      B=T2*A-C-6.614439341345433D-1 
      C=T2*B-A+1.287994098857678D+0 
      A=T2*C-B-1.191801160541217D+0 
      Y=T*A-C+6.483587706052649D-1 
20    S17AFF=Y*X*0.125D0 
      GOTO80 
40    G=T-1.5D0/TBPI 
      Y=DSIGN(DSQRT(TBPI/T),X) 
      CX=DCOS(G)*Y 
      SX=-DSIN(G)*Y*8.0D0/T 
      T=128.0D0/(T*T)-1.0D0 
      Y=+1.000907026278082D+0+T*(+8.988049416705579D-4+T*(-7.95969469843 
     *8460D-6+T*(+2.453676622275600D-7+T*(-1.470851298896000D-8+T*(+1.36 
     *0305801280000D-9+T*(-1.713107584000000D-10+T*(+2.720407296000000D- 
     *11+T*(-5.191139840000000D-12+T*(+1.146224640000000D-12+T*(-2.63372 
     *8000000000D-13+T*(+6.863872000000000D-14+T*(-3.545088000000000D-14 
     *+T*(+1.249280000000000D-14))))))))))))) 
      G=+4.677687402744898D-2+T*(-9.621458822054416D-5+T*(+1.82120185123 
     *0760D-6+T*(-8.291960709292000D-8+T*(+6.420132503440000D-9+T*(-7.15 
     *1105048000000D-10+T*(+1.039509318400000D-10+T*(-1.852480000000000D 
     *-11+T*(+3.875544320000000D-12+T*(-9.232281600000000D-13+T*(+2.5022 
     *46400000000D-13+T*(-7.439360000000000D-14+T*(+1.757184000000000D-1 
     *4+T*(-4.833280000000000D-15+T*(+5.324800000000000D-15+T*(-2.293760 
     *000000000D-15))))))))))))))) 
      S17AFF=Y*CX+G*SX 
      GOTO80 
60    IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S17AFF=DSQRT(TBPI/T) 
80    RETURN 
      END 
C 
C JZK0 
      DOUBLE PRECISION FUNCTION S18ACF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECISION X 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION EGAM,G,T,XBIG,XVSMAL,Y 
      DOUBLE PRECISION DLOG,DEXP,DSQRT 
      INTEGER P01AAF 
      DATA SRNAME/8H S18ACF / 
      DATA XVSMAL,EGAM/3.2D-9,5.772156649015329D-1/ 
      DATA XBIG/177.6D0/ 
      IF(X.LE.0.0D0)GOTO120 
      IFAIL=0 
      IF(X.LT.XBIG)GOTO20 
      S18ACF=0.0D0 
      GOTO140 
20    IF(X.GT.4.0D0)GOTO100 
      IF(X.GT.2.0D0)GOTO80 
      IF(X.GT.1.0D0)GOTO60 
      IF(X.GT.XVSMAL)GOTO40 
      S18ACF=-(DLOG(0.5D0*X)+EGAM) 
      GOTO140 
40    T=2.0D0*X*X-1.0D0 
      G=+1.128960929454128D+0+T*(+1.329769664783382D-1+T*(+4.07157485171 
     *3890D-3+T*(+5.597023382279154D-5+T*(+4.345626715461582D-7+T*(+2.16 
     *3824118247215D-9+T*(+7.491107368941348D-12+T*(+1.906741975145613D- 
     *14))))))) 
      Y=+2.618418792586871D-1+T*(+1.524369217993952D-1+T*(+6.63513979313 
     *9438D-3+T*(+1.095342926324015D-4+T*(+9.578784932659294D-7+T*(+5.19 
     *9068658006656D-9+T*(+1.924052642197067D-11+T*(+5.168678869463322D- 
     *14+T*(+1.054077181913600D-16)))))))) 
      S18ACF=-DLOG(X)*G+Y 
      GOTO140 
60    T=2.0D0*X-3.0D0 
      Y=+9.582100532948965D-1+T*(-1.424779101288283D-1+T*(+3.23582010649 
     *6530D-2+T*(-8.277803503516927D-3+T*(+2.247097296177705D-3+T*(-6.32 
     *6783574605949D-4+T*(+1.826524600893428D-4+T*(-5.371012088984418D-5 
     *+T*(+1.601859741497206D-5+T*(-4.831342503369222D-6+T*(+1.470557960 
     *782317D-6+T*(-4.510172923752000D-7+T*(+1.392172702246142D-7+T*(-4. 
     *321850898418341D-8+T*(+1.347904673613401D-8+T*(-4.205973292582499D 
     *-9+T*(+1.320693623859689D-9+T*(-4.333266656187809D-10+T*(+1.379992 
     *680744427D-10+T*(-3.192410591988521D-11+T*(+9.744101522706792D-12+ 
     *T*(-7.837386091085693D-12+T*(+2.574662885758206D-12))))))))))))))) 
     *))))))) 
      S18ACF=DEXP(-X)*Y 
      GOTO140 
80    T=X-3.0D0 
      Y=+6.977615980438518D-1+T*(-1.088018820849351D-1+T*(+2.56253646031 
     *9603D-2+T*(-6.744596079401692D-3+T*(+1.872929397259624D-3+T*(-5.37 
     *1456229719100D-4+T*(+1.574515162358606D-4+T*(-4.689366538148967D-5 
     *+T*(+1.413765093436227D-5+T*(-4.303738717272685D-6+T*(+1.320522610 
     *589324D-6+T*(-4.078512078621890D-7+T*(+1.266726294175674D-7+T*(-3. 
     *954032557135184D-8+T*(+1.239231378983469D-8+T*(-3.883497052505557D 
     *-9+T*(+1.224249827794330D-9+T*(-4.034246078719601D-10+T*(+1.289055 
     *874799801D-10+T*(-2.977875646332351D-11+T*(+9.111094308330013D-12+ 
     *T*(-7.396727839879332D-12+T*(+2.435382422475375D-12))))))))))))))) 
     *))))))) 
      S18ACF=DEXP(-X)*Y 
      GOTO140 
100   T=10.0D0/(1.0D0+X)-1.0D0 
      Y=+1.236886647694254D+0+T*(-1.726836523853216D-2+T*(-9.25551464765 
     *6371D-4+T*(-9.025533451874046D-5+T*(-6.316923983337465D-6+T*(-7.69 
     *1776225292729D-7+T*(-4.160448111741146D-8+T*(-9.415553211371761D-9 
     *+T*(+1.753593212735806D-10+T*(-2.228295822888333D-10+T*(+3.4956429 
     *32565460D-11+T*(-1.113917585726476D-11+T*(+2.854812351677059D-12+T 
     **(-7.313444826639319D-13+T*(+2.063288925625549D-13+T*(-1.281083108 
     *269916D-13+T*(+4.437419798865510D-14)))))))))))))))) 
      S18ACF=DEXP(-X)*Y/DSQRT(X) 
      GOTO140 
120   IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S18ACF=0.0D0 
140   RETURN 
      END 
C 
C JZK1 
      DOUBLE PRECISION FUNCTION S18ADF(X,IFAIL) 
      IMPLICIT REAL*8 (A-H,O-Z) 
      DOUBLE PRECISION X 
      INTEGER IFAIL 
      DOUBLE PRECISION SRNAME 
      DOUBLE PRECISION G,T,XBIG,XSEST,XSMALL,Y 
      DOUBLE PRECISION DLOG,DEXP,DSQRT 
      INTEGER P01AAF 
      DATA SRNAME/8H S18ADF / 
      DATA XSMALL/7.9D-10/ 
      DATA XBIG,XSEST/177.6D0,1.4D-36/ 
      IF(X.LE.0.0D0)GOTO120 
      IF(X.LE.XSEST)GOTO140 
      IFAIL=0 
      IF(X.LT.XBIG)GOTO20 
      S18ADF=0.0D0 
      GOTO160 
20    IF(X.GT.4.0D0)GOTO100 
      IF(X.GT.2.0D0)GOTO80 
      IF(X.GT.1.0D0)GOTO60 
      IF(X.GT.XSMALL)GOTO40 
      S18ADF=1.0D0/X 
      GOTO160 
40    T=2.0D0*X*X-1.0D0 
      G=+5.319078659133528D-1+T*(+3.257259881371105D-2+T*(+6.71642805873 
     *4987D-4+T*(+6.953002745482062D-6+T*(+4.327648236429978D-8+T*(+1.79 
     *7847923801558D-10+T*(+5.338882686656589D-13+T*(+1.189649624399104D 
     *-15))))))) 
     * 
      Y=+3.518258282893255D-1+T*(+4.504904429669437D-2+T*(+1.20333585658 
     *2190D-3+T*(+1.446124325330061D-5+T*(+9.966866892737815D-8+T*(+4.46 
     *8286284356187D-10+T*(+1.409171030245143D-12+T*(+3.298810580198656D 
     *-15))))))) 
      S18ADF=1.0D0/X+X*(DLOG(X)*G-Y) 
      GOTO160 
60    T=2.0D0*X-3.0D0 
     * 
      Y=+1.243165873552553D+0+T*(-2.719107143886894D-1+T*(+8.20250220860 
     *6939D-2+T*(-2.625458187294274D-2+T*(+8.573880870674101D-3+T*(-2.82 
     *4507878416560D-3+T*(+9.345941543876429D-4+T*(-3.100076810136266D-4 
     *+T*(+1.029827467000607D-4+T*(-3.424249122119421D-5+T*(+1.139301692 
     *025535D-5+T*(-3.792276988211429D-6+T*(+1.262655783319419D-6+T*(-4. 
     *205071523389350D-7+T*(+1.401383519851855D-7+T*(-4.669289121680201D 
     *-8+T*(+1.544566539090127D-8+T*(-5.137835081403322D-9+T*(+1.8280838 
     *13812054D-9+T*(-6.152114168988951D-10+T*(+1.280440239499463D-10+T* 
     *(-4.025910666270238D-11+T*(+4.274043305687672D-11+T*(-1.4663929178 
     *29485D-11))))))))))))))))))))))) 
      S18ADF=DEXP(-X)*Y 
      GOTO160 
80    T=X-3.0D0 
      Y=+8.065634801287869D-1+T*(-1.600526112913272D-1+T*(+4.58591528414 
     *0231D-2+T*(-1.423631366844236D-2+T*(+4.558657512067247D-3+T*(-1.48 
     *1854720326885D-3+T*(+4.857071747786637D-4+T*(-1.599948736215991D-4 
     *+T*(+5.287129191231318D-5+T*(-1.750895943540799D-5+T*(+5.806923118 
     *422967D-6+T*(-1.927945869964326D-6+T*(+6.405818140373983D-7+T*(-2. 
     *129692293463103D-7+T*(+7.087233666965699D-8+T*(-2.358556184610253D 
     *-8+T*(+7.794216511448327D-9+T*(-2.590393993080091D-9+T*(+9.2078168 
     *59061105D-10+T*(-3.096673923432451D-10+T*(+6.449134235458942D-11+T 
     **(-2.026804015147359D-11+T*(+2.147367510651332D-11+T*(-7.364782970 
     *504217D-12))))))))))))))))))))))) 
      S18ADF=DEXP(-X)*Y 
      GOTO160 
100   T=10.0D0/(1.0D0+X)-1.0D0 
      Y=+1.303875736042304D+0+T*(+5.448452543189316D-2+T*(+4.31639434283 
     *4454D-3+T*(+4.299739708987668D-4+T*(+4.047206315284950D-5+T*(+4.32 
     *7764097842352D-6+T*(+4.075638569318435D-7+T*(+4.866514200081540D-8 
     *+T*(+3.827176921214383D-9+T*(+6.776889438575889D-10+T*(+6.97075379 
     *1177314D-12+T*(+1.720260972859309D-11+T*(-2.607745020202711D-12+T* 
     *(+8.582115237135606D-13+T*(-2.192871044418028D-13+T*(+1.3932112294 
     *06003D-13+T*(-4.778502381115802D-14)))))))))))))))) 
      S18ADF=DEXP(-X)*Y/DSQRT(X) 
      GOTO160 
120   IFAIL=P01AAF(IFAIL,1,SRNAME) 
      S18ADF=0.0D0 
      GOTO160 
140   IFAIL=P01AAF(IFAIL,2,SRNAME) 
      S18ADF=1.0D0/XSEST 
160   RETURN 
      END 
C 
C JZI0 
      DOUBLE PRECISION FUNCTION S18AEF(X,IFAIL)                             
      IMPLICIT REAL*8 (A-H,O-Z)                                            
      DOUBLE PRECISION X                                                   
      INTEGER IFAIL                                                       
      DOUBLE PRECISION SRNAME                                              
      DOUBLE PRECISION G,T,XBIG,XVSMAL,Y,YBIG                              
      DOUBLE PRECISION DLOG,DEXP                                           
      INTEGER P01AAF                                                      
      DATA SRNAME/8H S18AEF /                                             
      DATA XVSMAL/3.2D-9/                                                 
      DATA XBIG,YBIG/177.2D0,2.7D+35/                                     
      T=DABS(X)                                                          
      IF(T.GT.XBIG)GOTO80                                                
      IFAIL=0                                                            
      IF(T.GT.12.0D0)GOTO60                                              
      IF(T.GT.4.0D0)GOTO40                                               
      IF(T.GT.XVSMAL)GOTO20                                              
      S18AEF=1.0D0                                                       
      GOTO100                                                            
20    G=DEXP(T)                                                          
      T=0.5D0*T-1.0D0                                                    
      Y=+3.085083225536710D-1+T*(-1.864780666094668D-1+T*(+1.57686843969 
     *9959D-1+T*(-1.288956213305250D-1+T*(+9.416163402008684D-2+T*(-6.04 
     *3167950077372D-2+T*(+3.415053883914522D-2+T*(-1.713179479357165D-2 
     *+T*(+7.700610522633826D-3+T*(-3.129232866563744D-3+T*(+1.158883197 
     *757917D-3+T*(-3.939345320725267D-4+T*(+1.236825949896927D-4+T*(-3. 
     *606455714448863D-5+T*(+9.813958627697871D-6+T*(-2.502989759665887D 
     *-6+T*(+6.005668610793301D-7+T*(-1.360420135071510D-7+T*(+2.9209616 
     *35211788D-8+T*(-5.948562732042595D-9+T*(+1.134159342153692D-9+T*(- 
     *2.100713601345520D-10+T*(+4.444844466378690D-11+T*(-7.481501657562 
     *350D-12)))))))))))))))))))))))                                     
      S18AEF=G*Y                                                         
      GOTO100                                                            
40    G=DEXP(T)                                                          
      T=0.25D0*T-2.0D0                                                   
      Y=+1.434317818568503D-1+T*(-3.715715425660853D-2+T*(+1.44861237337 
     *3595D-2+T*(-6.301216944598963D-3+T*(+2.893620465309687D-3+T*(-1.37 
     *6389069412322D-3+T*(+6.725085922737736D-4+T*(-3.358335132006794D-4 
     *+T*(+1.705245432679706D-4+T*(-8.743542911044678D-5+T*(+4.487390195 
     *801738D-5+T*(-2.282781552806685D-5+T*(+1.140324040217413D-5+T*(-5. 
     *549177621104829D-6+T*(+2.614576341422626D-6+T*(-1.187528406897655D 
     *-6+T*(+5.186325190695461D-7+T*(-2.176535488164477D-7+T*(+8.7529183 
     *91873057D-8+T*(-3.349002219343147D-8+T*(+1.241316683446164D-8+T*(- 
     *4.662154899837949D-9+T*(+1.585997762681723D-9+T*(-3.80370174256271 
     *6D-10+T*(+1.231881581754193D-10+T*(-8.469003079347549D-11+T*(+2.45 
     *1852529639411D-11))))))))))))))))))))))))))                        
      S18AEF=G*Y                                                         
      GOTO100                                                            
60    G=DEXP(T-0.5D0*DLOG(T))                                            
      T=24.0D0/T-1.0D0                                                   
      Y=+4.010710650668474D-1+T*(+2.182168172116944D-3+T*(+5.59848253337 
     *3778D-5+T*(+2.797707018497856D-6+T*(+2.171605010612221D-7+T*(+2.36 
     *8844340558435D-8+T*(+3.443450254314256D-9+T*(+6.479941177934721D-1 
     *0+T*(+1.561471274765288D-10+T*(+4.827266309888794D-11+T*(+1.895993 
     *229208008D-11+T*(+1.058636214256998D-11+T*(+8.277194012660470D-12+ 
     *T*(+2.828070564755550D-12+T*(-4.346247393576911D-12+T*(-4.29417106 
     *7205845D-12+T*(+4.308125773281362D-13+T*(+1.445723137991180D-12+T* 
     *(+4.732293068318310D-14+T*(-1.956798090476257D-13))))))))))))))))) 
     *))                                                                 
      S18AEF=G*Y                                                         
      GOTO100                                                            
80    IFAIL=P01AAF(IFAIL,1,SRNAME)                                       
      S18AEF=YBIG                                                        
100   RETURN                                                             
      END                                                                
C 
C JZI1 
      DOUBLE PRECISION FUNCTION S18AFF(X,IFAIL)                             
      IMPLICIT REAL*8 (A-H,O-Z)                                            
      DOUBLE PRECISION X                                                   
      INTEGER IFAIL                                                       
      DOUBLE PRECISION SRNAME                                              
      DOUBLE PRECISION G,T,XBIG,XVSMAL,Y,YBIG                              
      DOUBLE PRECISION DLOG,DEXP                                           
      INTEGER P01AAF                                                      
      DATA SRNAME/8H S18AFF /                                             
      DATA XVSMAL/3.2D-9/                                                 
      DATA XBIG,YBIG/177.2D0,2.7D+35/                                     
      T=DABS(X)                                                          
      IF(T.GT.XBIG)GOTO80                                                
      IFAIL=0                                                            
      IF(T.GT.12.0D0)GOTO60                                              
      IF(T.GT.4.0D0)GOTO40                                               
      IF(T.GT.XVSMAL)GOTO20                                              
      S18AFF=0.5D0*X                                                     
      GOTO100                                                            
20    T=0.125D0*T*T-1.0D0                                                
      Y=+1.197416549636702D+0+T*(+9.287588901146096D-1+T*(+2.68657659522 
     *0928D-1+T*(+4.092863718277705D-2+T*(+3.847639404238095D-3+T*(+2.45 
     *2243140392789D-4+T*(+1.128497957799518D-5+T*(+3.923687109963928D-7 
     *+T*(+1.066627123145040D-8+T*(+2.328569218846638D-10+T*(+4.17372709 
     *7882224D-12+T*(+6.243879103538483D-14)))))))))))                   
      S18AFF=X*Y                                                         
      GOTO100                                                            
40    G=DEXP(T)                                                          
      T=0.25D0*X-2.0D0                                                   
      Y=+1.341424932926982D-1+T*(-2.991409238974056D-2+T*(+9.76021102528 
     *6467D-3+T*(-3.407596479289564D-3+T*(+1.173134128559654D-3+T*(-3.67 
     *6261809921746D-4+T*(+8.479994381192881D-5+T*(+5.215573190702369D-6 
     *+T*(-2.620516785114182D-5+T*(+2.474932701335189D-5+T*(-1.790262227 
     *579486D-5+T*(+1.138189924424640D-5+T*(-6.631441629825098D-6+T*(+3. 
     *601861516177325D-6+T*(-1.839102066263488D-6+T*(+8.869515155451839D 
     *-7+T*(-4.054566115785511D-7+T*(+1.763052222400645D-7+T*(-7.2897829 
     *34841636D-8+T*(+2.849610412910177D-8+T*(-1.075635142076178D-8+T*(+ 
     *4.113212239049348D-9+T*(-1.415756174466296D-9+T*(+3.38883570696523 
     *4D-10+T*(-1.109703911046780D-10+T*(+7.799291764970566D-11+T*(-2.27 
     *0613761226179D-11))))))))))))))))))))))))))                        
      S18AFF=DSIGN(G*Y,X)                                                
      GOTO100                                                            
60    G=DEXP(T-0.5D0*DLOG(T))                                            
      T=24.0D0/T-1.0D0                                                   
     *                                                                   
      Y=+3.926244942041166D-1+T*(-6.405453603482374D-3+T*(-9.12475535508 
     *4971D-5+T*(-3.827951354535562D-6+T*(-2.726845457414009D-7+T*(-2.82 
     *5371208800417D-8+T*(-3.967571628632093D-9+T*(-7.281079610418280D-1 
     *0+T*(-1.720604907485832D-10+T*(-5.235241295335535D-11+T*(-2.029478 
     *546027581D-11+T*(-1.117955167422229D-11+T*(-8.696317666305636D-12+ 
     *T*(-3.059572934504202D-12+T*(+4.429664623196643D-12+T*(+4.47735589 
     *6570577D-12+T*(-3.953533039493775D-13+T*(-1.487650823159611D-12+T* 
     *(-5.771768117303706D-14+T*(+1.994485575980155D-13))))))))))))))))) 
     *))                                                                 
      S18AFF=DSIGN(G*Y,X)                                                
      GOTO100                                                      
80    IFAIL=P01AAF(IFAIL,1,SRNAME)                                  
      S18AFF=YBIG                                                    
100   RETURN                                                          
      END                                                        
C 
      INTEGER FUNCTION P01AAF(IFAIL,IERROR,SRNAME) 
      DOUBLE PRECISION SRNAME 
      IF(IFAIL.NE.1)GO TO 1 
C     SOFT FAIL OPTION WITH IFAIL=1 IN INPUT 
      P01AAF=IERROR 
      RETURN 
C     HARD FAIL OPTION WITH IFAIL=0 IN INPUT 
    1 IF(IERROR.NE.0)GO TO 2 
      P01AAF=IERROR 
      RETURN 
    2 WRITE(6,3)  SRNAME, IFAIL 
    3 FORMAT(' ERROR DETECTED BY FUNCTION LIBRARY ROUTINE ',2A4, 
     +     /,'                          WITH IFAIL= ',I8) 
      STOP 
      END 
